/* --- 基础样式 --- */
:root {
    --bg-gradient: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 50%, #0f3460 100%);
    --panel-bg: rgba(25, 25, 35, 0.95);
    --card-bg: rgba(40, 40, 50, 0.3);
    --settings-bg: rgba(20, 20, 25, 0.6);
    --accent: #00d2ff;
    --accent-hover: #33e0ff;
    --text-main: #ececec;
    --text-sub: #999;
    --danger: #ff4d4f;
    --border-color: rgba(255,255,255,0.08);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg-gradient); min-height: 100vh; color: var(--text-main); display: flex; flex-direction: column; align-items: center; padding: 30px 20px; }
header { text-align: center; margin-bottom: 30px; position: relative; z-index: 10; }
header h1 { font-size: 2.2rem; font-weight: 300; letter-spacing: 1px; margin-bottom: 8px; text-shadow: 0 0 15px rgba(0, 210, 255, 0.4); }
header span { color: var(--accent); font-weight: 600; }

.app-container { width: 100%; max-width: 800px; background: var(--panel-bg); backdrop-filter: blur(20px); border-radius: 16px; border: 1px solid var(--border-color); padding: 25px; box-shadow: 0 25px 70px rgba(0,0,0,0.6); z-index: 10; position: relative; }

/* --- 标签页切换 --- */
.tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; }
.tab-btn { flex: 1; background: transparent; border: 1px solid transparent; color: var(--text-sub); font-size: 1rem; cursor: pointer; padding: 10px; border-radius: 8px; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; }
.tab-btn:hover { background: rgba(255,255,255,0.05); color: var(--text-main); }
.tab-btn.active { background: rgba(0, 210, 255, 0.1); color: var(--accent); border-color: rgba(0, 210, 255, 0.3); font-weight: 600; }

/* --- 上传 & 进度条 --- */
.upload-zone { border: 2px dashed rgba(255,255,255,0.15); border-radius: 10px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s; background: rgba(0,0,0,0.2); margin-bottom: 20px; }
.upload-zone:hover { border-color: var(--accent); background: rgba(0, 210, 255, 0.08); }
.upload-zone i { font-size: 28px; color: var(--text-sub); margin-bottom: 8px; }
#file-input { display: none; }

/* 进度条样式 (New) */
#upload-progress-container { display: none; margin-bottom: 20px; background: rgba(0,0,0,0.2); padding: 10px 15px; border-radius: 8px; border: 1px solid var(--border-color); }
.progress-info { display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-sub); margin-bottom: 6px; }
.progress-bar-bg { background: rgba(255,255,255,0.1); height: 6px; border-radius: 3px; overflow: hidden; }
.progress-bar-fill { background: var(--accent); height: 100%; width: 0%; transition: width 0.1s ease-out; box-shadow: 0 0 10px rgba(0, 210, 255, 0.5); }

/* --- 文件列表 --- */
.file-list-container { max-height: 400px; overflow-y: auto; margin-bottom: 20px; padding-right: 5px; }
.file-list-container::-webkit-scrollbar { width: 6px; }
.file-list-container::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 3px; }
.file-list { list-style: none; display: flex; flex-direction: column; gap: 10px; }

.list-item-wrapper { background: var(--card-bg); border-radius: 8px; border: 1px solid var(--border-color); overflow: hidden; }
.file-card { padding: 10px 15px; display: flex; align-items: center; justify-content: space-between; cursor: grab; }
.file-info { display: flex; align-items: center; gap: 15px; flex: 1; overflow: hidden; }
.thumb-box { width: 32px; height: 32px; border-radius: 4px; background: rgba(0,0,0,0.3); display: flex; justify-content: center; align-items: center; overflow: hidden; flex-shrink: 0; }
.thumb-box img { width: 100%; height: 100%; object-fit: cover; }
.file-name { font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.card-actions button { background: transparent; border: none; color: var(--text-sub); cursor: pointer; padding: 5px 8px; border-radius: 4px; transition: 0.2s; }
.card-actions button:hover { color: var(--accent); background: rgba(255,255,255,0.1); }

/* 图片设置面板样式 */
.settings-panel { background: var(--settings-bg); padding: 10px 15px; border-top: 1px solid var(--border-color); display: none; font-size: 0.8rem; }
.settings-panel.show { display: block; }
.settings-row { display: flex; align-items: center; margin-bottom: 8px; }
.settings-label { width: 60px; color: var(--text-sub); }
input[type=range] { flex: 1; -webkit-appearance: none; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; outline: none; }
input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 12px; height: 12px; background: var(--accent); border-radius: 50%; cursor: pointer; }

/* 九宫格通用样式 */
.align-grid { display: grid; grid-template-columns: repeat(3, 20px); grid-gap: 3px; background: rgba(0,0,0,0.2); padding: 3px; border-radius: 3px; }
.align-btn { width: 20px; height: 20px; background: rgba(255,255,255,0.05); cursor: pointer; border-radius: 2px; position: relative; }
.align-btn.active { background: var(--accent); }
.align-btn::after { content: ''; display: block; width: 3px; height: 3px; background: rgba(255,255,255,0.3); margin: 8px auto; border-radius: 50%; }
.align-btn.active::after { background: #000; }
/* 偏移逻辑 */
.tl::after{ margin: 3px 0 0 3px; } .tc::after{ margin: 3px auto 0 auto; } .tr::after{ margin: 3px 3px 0 auto; }
.cl::after{ margin: auto 0 auto 3px; } .cc::after{ margin: auto; } .cr::after{ margin: auto 3px auto auto; }
.bl::after{ margin: auto 0 3px 3px; } .bc::after{ margin: auto auto 3px auto; } .br::after{ margin: auto 3px 3px auto; }

/* --- 签名区域样式 --- */
.signature-section { margin-top: 10px; border-top: 1px solid var(--border-color); padding-top: 15px; }
.sig-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.sig-title { font-size: 0.9rem; color: var(--accent); font-weight: 600; }

.btn-add-sig { background: rgba(0, 210, 255, 0.1); border: 1px dashed var(--accent); color: var(--accent); padding: 8px 15px; border-radius: 4px; cursor: pointer; font-size: 0.85rem; transition: 0.2s; }
.btn-add-sig:hover { background: rgba(0, 210, 255, 0.2); }

/* 签名预览与设置 */
.sig-preview-box { display: none; background: var(--settings-bg); border-radius: 8px; padding: 15px; margin-top: 10px; border: 1px solid var(--border-color); }
.sig-preview-box.active { display: flex; gap: 20px; align-items: center; }

.sig-img-wrap { width: 100px; height: 60px; background: #fff; border-radius: 4px; display: flex; justify-content: center; align-items: center; padding: 5px; position: relative; }
.sig-img-wrap img { max-width: 100%; max-height: 100%; object-fit: contain; }
.btn-del-sig { position: absolute; top: -5px; right: -5px; background: var(--danger); color: white; width: 18px; height: 18px; border-radius: 50%; border: none; cursor: pointer; display: flex; justify-content: center; align-items: center; font-size: 10px; }

.sig-controls { flex: 1; display: flex; flex-direction: column; gap: 10px; }
.control-row { display: flex; align-items: center; justify-content: space-between; font-size: 0.8rem; color: var(--text-sub); }
select.scope-select { background: #111; border: 1px solid #444; color: #eee; padding: 4px; border-radius: 4px; outline: none; }

/* --- 模态框 (Modal) --- */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; backdrop-filter: blur(5px); display: none; justify-content: center; align-items: center; }
.modal-box { background: #fff; width: 90%; max-width: 500px; border-radius: 12px; padding: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.5); position: relative; animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

.modal-title { color: #333; font-size: 1.1rem; font-weight: 600; margin-bottom: 15px; text-align: center; }
.canvas-wrapper { border: 2px dashed #ccc; border-radius: 8px; overflow: hidden; touch-action: none; background: #f9f9f9; position: relative; cursor: crosshair; }
canvas { display: block; width: 100%; height: 200px; }

.modal-actions { display: flex; gap: 10px; margin-top: 15px; }
.btn-modal { flex: 1; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 0.9rem; }
.btn-cancel { background: #f0f0f0; color: #555; }
.btn-clear { background: #ffecec; color: var(--danger); }
.btn-save { background: var(--accent); color: #000; }

/* --- 底部按钮 --- */
.action-bar { margin-top: 25px; display: flex; justify-content: space-between; align-items: center; }
.btn-merge { background: var(--accent); color: #09090b; border: none; padding: 12px 35px; border-radius: 6px; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 8px; opacity: 0.5; pointer-events: none; transition: all 0.3s; }
.btn-merge.active { opacity: 1; pointer-events: auto; box-shadow: 0 0 20px rgba(0, 210, 255, 0.3); }

/* Loading */
.loader { border: 2px solid rgba(0,0,0,0.1); border-top: 2px solid #000; border-radius: 50%; width: 16px; height: 16px; animation: spin 0.8s linear infinite; display: none; }
@keyframes spin { to { transform: rotate(360deg); } }